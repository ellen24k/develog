async function playAudioFromUrl(url, deviceId) {
    try {
        // AudioContext 생성
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        
        // 오디오 버퍼를 가져오기
        const response = await fetch(url);
        const arrayBuffer = await response.arrayBuffer();
        const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);

        // 소스 생성
        const source = audioContext.createBufferSource();
        source.buffer = audioBuffer;

        // 소스와 오디오 출력 장치 연결
        const destination = audioContext.createMediaStreamDestination();
        source.connect(destination);
        source.start(0);

        // Sink ID를 설정하여 특정 출력 장치에서 재생
        await audioContext.setSinkId(deviceId);
        
        // MediaStream을 소스에 연결
        const mediaStream = destination.stream;
        const mediaStreamSource = audioContext.createMediaStreamSource(mediaStream);
        mediaStreamSource.connect(audioContext.destination);

        console.log('Audio is playing on device:', deviceId);
    } catch (error) {
        console.error('Error playing audio:', error);
    }
}

// 사용 예시
async function startPlaying() {
    const devices = await getAudioOutputDevices();
    
    if (devices.length > 0) {
        const selectedDeviceId = devices[0].deviceId; // 첫 번째 장치 선택
        await playAudioFromUrl('https://raw.githubusercontent.com/ellen24k/ellen24k/main/snd_bg.wav', selectedDeviceId);
    } else {
        console.log('No audio output devices found.');
    }
}

// 시작 함수 호출
startPlaying();
